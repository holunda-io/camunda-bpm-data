<!DOCTYPE html>
<html lang="en">
<head>




<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>
<meta name="generator" content="Orchid 0.18.1-SNAPSHOT"/>
<link rel="icon" href="https://www.holunda.io/camunda-bpm-data/favicon.ico">


<meta name="robots" content="index, follow">



<title>Motivation</title>


<meta name="description" content="Beautiful process data handling for Camunda BPM.">




<link rel="next" href="https://www.holunda.io/camunda-bpm-data/wiki/user-guide/features">


<script>
    window.site = {"orchidVersion":"0.18.1-SNAPSHOT","baseUrl":"https://www.holunda.io/camunda-bpm-data","environment":"debug","version":"1.2.4"};
</script>





<!-- start:debug info -->

<!-- THEME -->
<!-- Type: BsDoc -->
<!-- Class: com.eden.orchid.bsdoc.BSDocTheme -->

<!-- PAGE -->
<!-- Type: wiki -->
<!-- Class: com.eden.orchid.wiki.pages.WikiPage -->
<!-- Layout: geopattern2, index -->
<!-- Resolved Layout: templates/layouts/geopattern2.peb -->
<!-- Page Template: wiki, page -->
<!-- Resolved Page Template: templates/pages/page.peb -->

<!-- RESOURCE -->
<!-- Class: com.eden.orchid.api.resources.resource.FileResource -->
<!-- Source Filename: wiki/user-guide/motivation.md -->

<!-- COMPLETE PAGE CONFIGURATION -->
<script>
    window.allData = {"reference":{"path":"wiki/user-guide","baseUrl":"https://www.holunda.io/camunda-bpm-data","fileName":"motivation","extension":"html","usePrettyUrl":true,"link":"https://www.holunda.io/camunda-bpm-data/wiki/user-guide/motivation"},"next":{"path":"wiki/user-guide","baseUrl":"https://www.holunda.io/camunda-bpm-data","fileName":"features","extension":"html","usePrettyUrl":true,"link":"https://www.holunda.io/camunda-bpm-data/wiki/user-guide/features"},"description":"","title":"Motivation"};
</script>

<!-- end:debug info -->




    <!-- start:inject components -->
    
        
            
        
    
    <!-- end:inject components -->



    <!-- start:inject components -->
    
    <!-- end:inject components -->





<!-- start:inject styles -->
<link rel="stylesheet" type="text/css" href="https://netdna.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css"  />
<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"  />
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.0/gh-fork-ribbon.min.css"  />
<link rel="stylesheet" type="text/css" href="https://www.holunda.io/camunda-bpm-data/BsDoc/753808c8/assets/css/bsdoc.css"  />
<link rel="stylesheet" type="text/css" href="https://www.holunda.io/camunda-bpm-data/BsDoc/753808c8/assets/css/orchidSearch.css"  />
<link rel="stylesheet" type="text/css" href="https://www.holunda.io/camunda-bpm-data/assets/css/asciidoc-admonitionblock.css"  />
<link rel="stylesheet" type="text/css" href="https://www.holunda.io/camunda-bpm-data/assets/css/orchidSearch.css"  />
<link rel="stylesheet" type="text/css" href="https://rawgit.com/PrismJS/prism-themes/master/themes/prism-darcula.css"  />
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/plugins/line-numbers/prism-line-numbers.min.css"  />
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/plugins/line-highlight/prism-line-highlight.min.css"  />
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/plugins/toolbar/prism-toolbar.min.css"  />
<!-- end:inject styles -->


</head>
<body>




<a class="github-fork-ribbon right-top"
   href="https://github.com/holunda-io/camunda-bpm-data"
   title="Fork me on GitHub">Fork me on GitHub</a>


<header class="navbar navbar-fixed-top bs-docs-nav">
    <div class="container">
        <div class="navbar-header" role="banner">
            <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://www.holunda.io/camunda-bpm-data">Camunda BPM Data</a>
        </div>
        <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
            <ul class="nav navbar-nav navbar-right">
                
                    
                        <li><a href="https://www.holunda.io/camunda-bpm-data/quick-start">Quick Start</a></li>
                    
                
                    
                        <li class="dropdown">
                            <a class="dropdown-toggle" data-toggle="dropdown" href="#">User Guide<span class="caret"></span></a>
                            <ul class="dropdown-menu scrollable-menu">
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/wiki/user-guide/motivation">Motivation</a></li>
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/wiki/user-guide/features">Features</a></li>
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/wiki/user-guide/examples-java">Java Examples</a></li>
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/wiki/user-guide/examples-kotlin">Kotlin Examples</a></li>
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/wiki/user-guide/examples-no-engine">Example no engine</a></li>
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/wiki/user-guide/further-outlook">Further outlook</a></li>
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/changelog">Changelog</a></li>
                                
                            </ul>
                        </li>
                    
                
                    
                        <li class="dropdown">
                            <a class="dropdown-toggle" data-toggle="dropdown" href="#">Developer Guide<span class="caret"></span></a>
                            <ul class="dropdown-menu scrollable-menu">
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/wiki/developer-guide/contribution">Contribution</a></li>
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/wiki/developer-guide/project-setup">Project Setup</a></li>
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/readme">Readme</a></li>
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/license">License</a></li>
                                
                            </ul>
                        </li>
                    
                
                    
                        <li class="dropdown">
                            <a class="dropdown-toggle" data-toggle="dropdown" href="#">Java Packages<span class="caret"></span></a>
                            <ul class="dropdown-menu scrollable-menu">
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/javadoc/io/holunda/camunda/bpm/data">io.holunda.camunda.bpm.data</a></li>
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/javadoc/io/holunda/camunda/bpm/data/adapter">io.holunda.camunda.bpm.data.adapter</a></li>
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/javadoc/io/holunda/camunda/bpm/data/adapter/basic">io.holunda.camunda.bpm.data.adapter.basic</a></li>
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/javadoc/io/holunda/camunda/bpm/data/adapter/list">io.holunda.camunda.bpm.data.adapter.list</a></li>
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/javadoc/io/holunda/camunda/bpm/data/adapter/map">io.holunda.camunda.bpm.data.adapter.map</a></li>
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/javadoc/io/holunda/camunda/bpm/data/adapter/set">io.holunda.camunda.bpm.data.adapter.set</a></li>
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/javadoc/io/holunda/camunda/bpm/data/builder">io.holunda.camunda.bpm.data.builder</a></li>
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/javadoc/io/holunda/camunda/bpm/data/factory">io.holunda.camunda.bpm.data.factory</a></li>
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/javadoc/io/holunda/camunda/bpm/data/reader">io.holunda.camunda.bpm.data.reader</a></li>
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/javadoc/io/holunda/camunda/bpm/data/writer">io.holunda.camunda.bpm.data.writer</a></li>
                                
                            </ul>
                        </li>
                    
                
                    
                        <li class="dropdown">
                            <a class="dropdown-toggle" data-toggle="dropdown" href="#">Kotlin Packages<span class="caret"></span></a>
                            <ul class="dropdown-menu scrollable-menu">
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/kotlindoc/io/holunda/camunda/bpm/data">io.holunda.camunda.bpm.data</a></li>
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/kotlindoc/io/holunda/camunda/bpm/data/acl">io.holunda.camunda.bpm.data.acl</a></li>
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/kotlindoc/io/holunda/camunda/bpm/data/acl/apply">io.holunda.camunda.bpm.data.acl.apply</a></li>
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/kotlindoc/io/holunda/camunda/bpm/data/acl/transform">io.holunda.camunda.bpm.data.acl.transform</a></li>
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/kotlindoc/io/holunda/camunda/bpm/data/adapter">io.holunda.camunda.bpm.data.adapter</a></li>
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/kotlindoc/io/holunda/camunda/bpm/data/guard">io.holunda.camunda.bpm.data.guard</a></li>
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/kotlindoc/io/holunda/camunda/bpm/data/guard/condition">io.holunda.camunda.bpm.data.guard.condition</a></li>
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/kotlindoc/io/holunda/camunda/bpm/data/guard/integration">io.holunda.camunda.bpm.data.guard.integration</a></li>
                                
                                    <li><a href="https://www.holunda.io/camunda-bpm-data/kotlindoc/io/holunda/camunda/bpm/data/mockito">io.holunda.camunda.bpm.data.mockito</a></li>
                                
                            </ul>
                        </li>
                    
                
            </ul>
        </nav>
    </div>
</header>


<div id="top"></div>


    <div class="bs-docs-header" id="jumbotron">
        <div class="container">
            <h1 class="home-title">Motivation</h1>
        </div>
    </div>


<div class="container bs-docs-container">
    <div class="row">
        <div class="col-md-9" role="main">
        <nav aria-label="breadcrumb">
    <ul class="breadcrumb">
    
    
        <li class="breadcrumb-item"><a href="https://www.holunda.io/camunda-bpm-data/wiki">Wiki</a></li>
    
    
    
        <li class="breadcrumb-item"><a href="https://www.holunda.io/camunda-bpm-data/wiki/user-guide">User Guide</a></li>
    
    
    
        <li class="breadcrumb-item active" aria-current="page">Motivation</li>
    
    
    </ul>
</nav>
        

        
        
            
    <!-- start:inject components -->
    
        
            
        
            
                
                    
                        <h2 id="motivation"><a href="#motivation" id="motivation" class="anchor"></a>Motivation</h2>
<h3 id="typed-access-to-process-variables"><a href="#typed-access-to-process-variables" id="typed-access-to-process-variables" class="anchor"></a>Typed access to process variables</h3>
<p>Camunda BPM engine provide Java API to access the process variables.
This consists of:</p>
<ul>
<li><code>RuntimeService</code> methods</li>
<li><code>TaskService</code> methods</li>
<li>Methods on <code>DelegateExecution</code></li>
<li>Methods on <code>DelegateTask</code></li>
<li><code>VariableMap</code></li>
</ul>
<p>All those methods requires the user of the API to know the variable type.
Here is a usage example:</p>
<pre><code class="language-java">ProcessInstance processInstance = ...;
List&lt;OrderPosition&gt; orderPositions = (List&lt;OrderPosition&gt;) runtimeService
  .getVariable(processInstance.id, &quot;orderPositions&quot;);
</code></pre>
<p>This leads to problems during refactoring and makes variable access more complicated than it is. This library addresses
this issue and allows for more convenient type-safe process variable access.</p>
<p>More details can be found in:</p>
<ul>
<li><a href="https://medium.com/holisticon-consultants/data-in-process-part-1-2620bf9abd76">Data in Process (Part 1)</a></li>
<li><a href="https://medium.com/holisticon-consultants/data-in-process-part-2-7c6a109e6ee2">Data in Process (Part 2)</a></li>
</ul>
<h3 id="variable-guards"><a href="#variable-guards" id="variable-guards" class="anchor"></a>Variable guards</h3>
<p>Process automation often follows strict rules defined by the business. On the other hand, the process execution itself
defines rules in terms of pre- and post-conditions on the process payload (stored as process variables in Camunda BPM).
Rising complexity of the implemented processes makes the compliance to those rules challenging. In order to fulfill the
conditions on process variables during the execution of business processes, a concept of <code>VariableGuard</code> is provided by
the library. A guard consists of a set of <code>VariableConditions</code> and can be evaluated in all contexts, the variables
are used in: <code>DelegateTask</code>, <code>DelegateExecution</code>, <code>TaskService</code>, <code>RuntimeService</code>, <code>VariableMap</code>.</p>
<p>Here is an example of a task listener verifying that a process variable <code>ORDER_APPROVED</code> is set, which
will throw a <code>GuardViolationException</code> if the condition is not met.</p>
<pre><code class="language-java">
import static io.holunda.camunda.bpm.data.guard.CamundaBpmDataGuards.exists;

@Component
class MyGuardListener extends DefaultGuardTaskListener {

    public MyGuardListener() {
        super(newArrayList(exists(ORDER_APPROVED)), true);
    }
}
</code></pre>
<h3 id="anti-corruption-layer"><a href="#anti-corruption-layer" id="anti-corruption-layer" class="anchor"></a>Anti-Corruption-Layer</h3>
<p>If a process is signalled or hit by a correlated message, there is no way to check if the transported variables are set correctly.
In addition, the variables are written directly to the execution of the correlated process instance. In case of a multi-instance
event-base sub-process this will eventually overwrite the values of the main execution.</p>
<p>To prevent all this, a feature called Anti-Corruption-Layer (ACL) is implemented. An ACL is there to protect the execution
from bad modifications and influence the way, the modification is executed. For the protection, an ACL relies on a Variables Guards,
defining conditions to be satisfied. For the influencing of modification, the <code>VariableMapTransformer</code> can be used.</p>
<p>To use the ACL layer you will need to change the way you correlate messages (or signal the execution). Instead of supplying the variables
directly to the <code>correlate</code> method of the <code>RuntimeService</code>, the client is wrapping all variables into a map hold by a single transient variable
and correlate this variable with the process (we call this procedure variable wrapping). On the process side, an execution listener placed
on the end of the catch event is responsible to extract the variable map from the transient variable, check it by passing through the <code>VariablesGuard</code>
and finally pass over to the <code>VariableMapTransformer</code> to map from external to internal representation.</p>
<p>Here is the code, required on the client side to correlate the message.</p>
<pre><code class="language-java">@Component
class SomeService {

    private static AntiCorruptionLayer MY_ACL = CamundaBpmDataACL.guardTransformingReplace(
        &quot;__transient&quot;, // name of the transient variable for wrapping
        true, // if passes the guard, write to local scope
        new VariablesGuard(exists(ORDER_ID)), // guard defining condition on ORDER_ID
        IdentityVariableMapTransformer.INSTANCE // use 1:1 transformer
                                                // write the variables without modifications
    );

    public void correlate() {
        VariableMap variables = CamundaBpmData.builder()
          .set(ORDER_ID, &quot;4711&quot;)
          .set(ORDER_APPROVED, false)
          .build();
        runtimeService.correlateMessage(&quot;message_1&quot;, MESSAGE_ACL.checkAndWrap(variables));
    }
}
</code></pre>
<p>On the process side, the BPMN message catch event should have an <code>End</code> listener responsible for unwrapping the values. If the listener is
implemented as a Spring Bean bounded via delegate expression <code>${messageAclListener}</code> then the following code is responsible for providing such a listener:</p>
<pre><code class="language-java">@Configuration
class SomeConfiguration {

    private static AntiCorruptionLayer MY_ACL = CamundaBpmDataACL.guardTransformingReplace(
        &quot;__transient&quot;, // name of the transient variable for wrapping
        true, // if passes the guard, write to local scope
        new VariablesGuard(exists(ORDER_ID)), // guard defining condition on ORDER_ID
        IdentityVariableMapTransformer.INSTANCE // use 1:1 transformer
                                                // write the variables without modifications
    );

    @Bean(&quot;messageAclListener&quot;)
    public ExecutionListener messageAclListener() {
        return MY_ACL.getExecutionListener();
    }
}
</code></pre>
<p>Such a setup will only allow to correlate messages, if the variables provided include a value for the <code>ORDER_ID</code>. It will write all
variables provided (<code>ORDER_ID</code> and <code>ORDER_APPROVED</code>) into a local scope of the execution.</p>

                    
                
            
        
    
    <!-- end:inject components -->


        
        </div>

        <!-- Page navigation
        =========================================== -->
        <div class="col-md-3" role="complementary">
        <div class="bs-docs-sidebar hidden-print" id="bs-docs-sidebar">
    <section id="search" >
        <form data-orchid-search="">
            <div class="input-group">
                <input type="text" name="query" id="query" class="form-control" placeholder="Search&hellip;">
                <span class="input-group-btn"><button type="submit" class="btn btn-default">Go</button></span>
            </div>
        </form>
        <div id="search-results" data-orchid-search-results style="display: none;">
            <b>Search Results</b>
            <ul></ul>
        </div>
        <div id="search-progress" data-orchid-search-progress style="display: none;">
            <div class="loader">Loading...</div>
        </div>
    </section>

    <ul class="nav bs-docs-sidenav">
        
        
            
                
                    <li><a class="divider-subheader">In This Page</a></li>
                
            
        
        
            
                <li class="has-children ">
                    <a>Motivation</a>
                    <ul class="nav">
                        
                        
                            
                                <li class="">
                                    <a href="#typed-access-to-process-variables">Typed access to process variables</a>
                                </li>
                            
                        
                            
                                <li class="">
                                    <a href="#variable-guards">Variable guards</a>
                                </li>
                            
                        
                            
                                <li class="">
                                    <a href="#anti-corruption-layer">Anti-Corruption-Layer</a>
                                </li>
                            
                        
                    </ul>
                </li>
            
        
        
            
                
                    <li><a class="divider-subheader">User guide</a></li>
                
            
        
    </ul>

    
    <!-- start:inject components -->
    
    <!-- end:inject components -->



    <a class="back-to-top" href="#top">
        <i class="glyphicon glyphicon-chevron-up"></i> Back to top
    </a>
</div>

        </div>
    </div>
</div>


<div id="footer">
    <div class="container bs-docs-container">
    <footer class="bs-docs-footer" role="contentinfo">
    <div class="row">
        <div class="col-xs-12">
            <nav aria-label="navigateClasses">
                <ul class="pager">
                    

                    
                        <li class="next">
                            <a href="https://www.holunda.io/camunda-bpm-data/wiki/user-guide/features">
                                <span>Features</span>
                                <span aria-hidden="true">&rarr;</span>
                            </a>
                        </li>
                    
                </ul>
            </nav>
        </div>
    </div>
    <div class="icons">
    
    
        <a href="https://www.holunda.io/camunda-bpm-data/" class="fa fas fa-home"></a>
    
        <a href="https://github.com/holunda-io/camunda-bpm-data" class="fa fa-github"></a>
    
        <a href="https://twitter.com/holisticon" class="fa fa-twitter"></a>
    
    
    </div>
    <br>
    <p>
    Documentation template based on the
    <a href="https://github.com/mistic100/jekyll-bootstrap-doc">Jekyll Bootstrap Doc</a>
    Jekyll theme by the <a href="https://getbootstrap.com">Bootstrap team</a>. Site created with
    <a href="https://orchid.run">Orchid</a>.
</p>

<ul class="bs-docs-footer-links muted">
    <li>Currently 1.2.4</li>
</ul>


</footer>
    </div>
</div>


<!-- start:inject scripts -->
<script  src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script  src="https://netdna.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
<script  src="https://cdnjs.cloudflare.com/ajax/libs/bootbox.js/4.3.0/bootbox.min.js"></script>
<script  src="https://www.holunda.io/camunda-bpm-data/BsDoc/753808c8/assets/js/bsdoc.js"></script>
<script  src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script  src="https://unpkg.com/lunr/lunr.js"></script>
<script  src="https://www.holunda.io/camunda-bpm-data/assets/js/orchidSearch.js"></script>
<script  src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/prism.min.js"></script>
<script  src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-yaml.min.js"></script>
<script  src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-java.min.js"></script>
<script  src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-json.min.js"></script>
<script  src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-kotlin.min.js"></script>
<script  src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-markdown.min.js"></script>
<script  src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/plugins/line-numbers/prism-line-numbers.min.js"></script>
<script  src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/plugins/line-highlight/prism-line-highlight.min.js"></script>
<script  src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/plugins/toolbar/prism-toolbar.min.js"></script>
<script  src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/plugins/show-language/prism-show-language.min.js"></script>
<script  src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js"></script>
<script  src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
<!-- end:inject scripts -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/geopattern/1.2.3/js/geopattern.min.js"></script>

<script>
    $(function () {
        window.colors = ['#B10000', '#000000'];
                  
    
        geopattern('Motivation');
    

        buildNav();
    });
</script>

</body>
</html>